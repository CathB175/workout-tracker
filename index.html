<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workout Tracker</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #f9fafb; }
        .header { background: #3b82f6; color: white; padding: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .header h1 { font-size: 20px; text-align: center; }
        .back-btn { background: none; border: none; color: white; font-size: 16px; cursor: pointer; float: left; }
        .container { padding: 24px 24px 100px 24px; }
        .title { font-size: 28px; font-weight: bold; margin-bottom: 8px; }
        .subtitle { color: #6b7280; margin-bottom: 32px; font-size: 14px; }
        .card { background: white; padding: 16px; border-radius: 8px; border: 2px solid #f3f4f6; margin-bottom: 12px; cursor: pointer; }
        .card:active { background: #f9fafb; }
        .card h3 { font-weight: 600; font-size: 18px; margin-bottom: 4px; }
        .card p { font-size: 14px; color: #6b7280; margin-bottom: 4px; }
        .card small { font-size: 12px; color: #9ca3af; display: block; margin-top: 4px; }
        .card .equipment { font-size: 13px; color: #f59e0b; margin-top: 6px; font-weight: 500; }
        .empty-state { text-align: center; color: #9ca3af; padding: 40px 20px; font-size: 15px; }
        .nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; border-top: 1px solid #e5e7eb; display: flex; }
        .nav button { flex: 1; padding: 16px; background: none; border: none; color: #9ca3af; font-size: 12px; cursor: pointer; }
        .nav button.active { color: #3b82f6; }
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.75); padding: 20px; overflow-y: auto; z-index: 9999; }
        .modal.show { display: block; }
        .modal-content { background: white; margin: 20px auto; padding: 24px; border-radius: 12px; max-width: 400px; }
        .modal h3 { font-size: 22px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #eee; }
        .workout-details { background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 16px; font-size: 14px; }
        .workout-details strong { display: block; margin-bottom: 4px; color: #111; }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 6px; font-size: 14px; }
        .form-group input, .form-group textarea { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; font-family: inherit; }
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        .btn { flex: 1; padding: 14px; border: none; border-radius: 8px; font-weight: 600; font-size: 16px; cursor: pointer; }
        .btn-cancel { background: #e5e7eb; color: #111; }
        .btn-save { background: #3b82f6; color: white; }
        .hidden { display: none; }
        .history-card { background: white; padding: 14px; border-radius: 8px; border: 2px solid #f3f4f6; margin-bottom: 10px; }
        .history-card h4 { font-size: 16px; font-weight: 600; margin-bottom: 6px; }
        .history-card .meta { font-size: 12px; color: #6b7280; margin-bottom: 8px; }
        .history-card .notes { font-size: 14px; color: #374151; font-style: italic; background: #f9fafb; padding: 8px; border-radius: 6px; margin-top: 8px; }
        .badge { display: inline-block; background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-top: 4px; }
    </style>
</head>
<body>
    <div class="header">
        <button class="back-btn hidden" id="backBtn" onclick="goBack()">‚Üê Back</button>
        <h1>Workout Tracker</h1>
    </div>

    <div class="container" id="homeView">
        <h1 class="title">What do you fancy doing?</h1>
        <p class="subtitle">Choose your workout type</p>
        <div id="typesList"></div>
    </div>

    <div class="container hidden" id="cyclesView">
        <h2 class="title" id="cyclesTitle"></h2>
        <p class="subtitle" id="cyclesSubtitle"></p>
        <div id="cyclesList"></div>
    </div>

    <div class="container hidden" id="sessionsView">
        <h2 class="title" id="sessionsTitle"></h2>
        <p class="subtitle">Choose a session</p>
        <div id="sessionsList"></div>
    </div>

    <div class="container hidden" id="workoutsView">
        <h2 class="title" id="workoutsTitle"></h2>
        <p class="subtitle" id="workoutsSubtitle"></p>
        <div id="workoutsList"></div>
    </div>

    <div class="container hidden" id="historyView">
        <h2 class="title">Workout History</h2>
        <div id="historyList"></div>
    </div>

    <div class="modal" id="logModal">
        <div class="modal-content">
            <h3>Log Workout</h3>
            <div class="workout-details" id="workoutDetails"></div>
            <div class="form-group">
                <label>Date</label>
                <input type="date" id="logDate">
            </div>
            <div class="form-group">
                <label>Duration (minutes)</label>
                <input type="number" id="logDuration" placeholder="25">
            </div>
            <div class="form-group">
                <label>Equipment Used</label>
                <input type="text" id="logEquipment" placeholder="Dumbbells, resistance band, etc.">
            </div>
            <div class="form-group">
                <label>Notes</label>
                <textarea id="logNotes" rows="3" placeholder="Weights used, how it felt, modifications..."></textarea>
            </div>
            <div class="btn-group">
                <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
                <button class="btn btn-save" onclick="saveWorkout()">Save</button>
            </div>
        </div>
    </div>

    <div class="nav">
        <button id="homeNavBtn" class="active" onclick="showHome()">
            <div>üè†</div>
            Home
        </button>
        <button id="historyNavBtn" onclick="showHistory()">
            <div>üìã</div>
            History
        </button>
    </div>

    <script>
        let currentView = 'home';
        let selectedType = null;
        let selectedCycle = null;
        let selectedWorkout = null;
        let history = JSON.parse(localStorage.getItem('workoutHistory') || '[]');

        const types = [
            { id: 'hiit', name: 'HIIT', description: 'High-Intensity Interval Training from The Body Coach', hasCycles: true },
            { id: 'strength', name: 'Strength in Menopause', description: 'Building strength and stability with The Body Coach' },
            { id: 'barre', name: 'Barre', description: 'Define strength and lengthen with The Body Coach' },
            { id: 'yoga-pilates', name: 'Yoga & Pilates', description: 'Flow and strengthen with The Body Coach' },
            { id: 'smm', name: 'SMM', description: 'Simple Mobility Method for daily movements' },
            { id: 'stability', name: 'Stability Builder', description: 'Build a solid core foundation and improve balance' },
            { id: 'spf', name: 'SPF', description: 'Keeping your shoulders neck and upper back happy' }
        ];

        const data = {
            hiit: {
                cycles: [
                    { 
                        id: 1, 
                        name: 'Cycle 1', 
                        workouts: [
                            { session: 1, name: 'Cycle 1 - Workout 1', info: 'HIIT 5 moves x 5 rounds 30s work 30s rest', duration: 25, equipment: '', notes: 'Good - all standing' },
                            { session: 2, name: 'Cycle 1 - Workout 2', info: 'HIIT 5 moves x 5 rounds 30s work 30s rest', duration: 25, equipment: '', notes: '' },
                            { session: 3, name: 'Cycle 1 - Workout 3', info: 'HIIT 6 moves x 4 rounds 30s work 30s rest', duration: 25, equipment: '', notes: '' },
                            { session: 4, name: 'Cycle 1 - Workout 4', info: 'HIIT 8 moves x 3 rounds 30s work 30s rest', duration: 25, equipment: '', notes: '' },
                            { session: 5, name: 'Cycle 1 - Workout 5', info: 'HIIT 12 moves x 2 rounds 30s work 30s rest', duration: 25, equipment: '', notes: '' }
                        ]
                    },
                    { 
                        id: 2, 
                        name: 'Cycle 2', 
                        workouts: [
                            { session: 1, name: 'Cycle 2 - Workout 1', info: 'HIIT 10 moves x 3 rounds 30s work 30s rest', duration: 30, equipment: '', notes: '' },
                            { session: 2, name: 'Cycle 2 - Workout 2', info: 'Cardio & Abs HIIT 10 moves x 3 rounds 30s work 30s rest', duration: 30, equipment: '', notes: '' },
                            { session: 3, name: 'Cycle 2 - Workout 3', info: 'HIIT 15 moves x 2 rounds 30s work 30s rest', duration: 30, equipment: '', notes: '' },
                            { session: 4, name: 'Cycle 2 - Workout 4', info: 'HIIT 5 moves x 6 rounds 30s work 30s rest', duration: 30, equipment: '', notes: '' },
                            { session: 5, name: 'Cycle 2 - Workout 5', info: 'HIIT 7 moves x 4 rounds 30s work 30s rest', duration: 30, equipment: '', notes: '' }
                        ]
                    },
                    { 
                        id: 3, 
                        name: 'Cycle 3', 
                        workouts: [
                            { session: 1, name: 'Cycle 3 - Workout 1', info: 'HIIT 10 moves x 3 rounds 35s work 25s rest', duration: 30, equipment: '', notes: '' },
                            { session: 2, name: 'Cycle 3 - Workout 2', info: 'Lower Body 5 moves x 2 rounds - Upper Body 5 moves x 2 rounds 35s work 25s rest', duration: 30, equipment: '', notes: '' },
                            { session: 3, name: 'Cycle 3 - Workout 3', info: 'HIIT 8 moves x 3 rounds 35s work 25s rest - Abs circuit 5 moves x 1 round 30s work 30s rest', duration: 30, equipment: '', notes: '' },
                            { session: 4, name: 'Cycle 3 - Workout 4', info: 'Lower Body 5 moves x 2 rounds - Upper Body 5 moves x 2 rounds 30s work 30s rest - Cardio 5 moves x 2 rounds 30s work 30s rest', duration: 30, equipment: '', notes: '' },
                            { session: 5, name: 'Cycle 3 - Workout 5', info: 'HIIT 15 moves x 2 rounds 35s work 25s rest then 40s work 20s rest', duration: 30, equipment: '', notes: '' }
                        ]
                    }
                ]
            },
            strength: [],
            barre: [],
            'yoga-pilates': [],
            smm: [],
            stability: [],
            spf: []
        };

        function getLast(type, cycle = null, session = null) {
            return history.filter(h => {
                if (h.type !== type) return false;
                if (cycle && h.cycle !== cycle) return false;
                if (session && h.session !== session) return false;
                return true;
            }).sort((a,b) => new Date(b.date) - new Date(a.date))[0];
        }

        function getNext(type) {
            const last = getLast(type);
            if (!last) return { cycle: 1, session: 1 };
            if (last.session < 5) return { cycle: last.cycle, session: last.session + 1 };
            if (last.cycle < 3) return { cycle: last.cycle + 1, session: 1 };
            return { cycle: 1, session: 1 };
        }

        function hideAll() {
            document.querySelectorAll('.container').forEach(el => el.classList.add('hidden'));
            document.getElementById('backBtn').classList.add('hidden');
        }

        function showHome() {
            hideAll();
            currentView = 'home';
            selectedType = null;
            selectedCycle = null;
            selectedWorkout = null;
            document.getElementById('homeView').classList.remove('hidden');
            document.getElementById('homeNavBtn').classList.add('active');
            document.getElementById('historyNavBtn').classList.remove('active');
            renderTypes();
        }

        function renderTypes() {
            const list = document.getElementById('typesList');
            list.innerHTML = types.map(type => {
                const last = getLast(type.id);
                const next = type.id === 'hiit' ? getNext(type.id) : null;
                let lastText = '';
                if (last) {
                    lastText = `<small>Last: ${new Date(last.date).toLocaleDateString()}`;
                    if (last.cycle) lastText += ` - Cycle ${last.cycle} Session ${last.session}`;
                    lastText += '</small>';
                }
                let nextText = '';
                if (next) nextText = `<small style="color: #3b82f6;">Next: Cycle ${next.cycle} Session ${next.session}</small>`;
                return `<div class="card" onclick="selectType('${type.id}')">
                    <h3>${type.name}</h3>
                    <p>${type.description}</p>
                    ${lastText}${nextText}
                </div>`;
            }).join('');
        }

        function selectType(typeId) {
            selectedType = types.find(t => t.id === typeId);
            if (selectedType.hasCycles) {
                showCycles();
            } else {
                showWorkouts();
            }
        }

        function showCycles() {
            hideAll();
            currentView = 'cycles';
            document.getElementById('cyclesView').classList.remove('hidden');
            document.getElementById('backBtn').classList.remove('hidden');
            const next = getNext(selectedType.id);
            document.getElementById('cyclesTitle').textContent = selectedType.name;
            document.getElementById('cyclesSubtitle').textContent = `Next up: Cycle ${next.cycle} Session ${next.session}`;
            
            const list = document.getElementById('cyclesList');
            list.innerHTML = data.hiit.cycles.map(cycle => {
                const last = getLast(selectedType.id, cycle.id);
                let lastText = '';
                if (last) lastText = `<small>Last: Session ${last.session} - ${new Date(last.date).toLocaleDateString()}</small>`;
                return `<div class="card" onclick="selectCycle(${cycle.id})">
                    <h3>${cycle.name}</h3>
                    <p>5 sessions</p>
                    ${lastText}
                </div>`;
            }).join('');
        }

        function selectCycle(cycleId) {
            selectedCycle = cycleId;
            showSessions();
        }

        function showSessions() {
            hideAll();
            currentView = 'sessions';
            document.getElementById('sessionsView').classList.remove('hidden');
            document.getElementById('backBtn').classList.remove('hidden');
            document.getElementById('sessionsTitle').textContent = `Cycle ${selectedCycle}`;
            
            const list = document.getElementById('sessionsList');
            const cycle = data.hiit.cycles.find(c => c.id === selectedCycle);
            list.innerHTML = cycle.workouts.map(workout => {
                const last = getLast(selectedType.id, selectedCycle, workout.session);
                let lastText = '';
                if (last) {
                    lastText = `<small>Last: ${new Date(last.date).toLocaleDateString()}`;
                    if (last.duration) lastText += ` - ${last.duration} mins`;
                    lastText += '</small>';
                }
                return `<div class="card" onclick='selectSessionWorkout(${JSON.stringify(workout)})'>
                    <h3>Session ${workout.session}</h3>
                    <p>${workout.info}</p>
                    ${workout.equipment ? `<div class="equipment">Equipment: ${workout.equipment}</div>` : ''}
                    ${workout.notes ? `<div class="badge">Tip: ${workout.notes}</div>` : ''}
                    ${lastText}
                </div>`;
            }).join('');
        }

        function selectSessionWorkout(workout) {
            selectedWorkout = workout;
            openModal();
        }

        function showWorkouts() {
            hideAll();
            currentView = 'workouts';
            document.getElementById('workoutsView').classList.remove('hidden');
            document.getElementById('backBtn').classList.remove('hidden');
            document.getElementById('workoutsTitle').textContent = selectedType.name;
            document.getElementById('workoutsSubtitle').textContent = selectedType.description;
            
            const list = document.getElementById('workoutsList');
            const workouts = data[selectedType.id];
            
            if (!workouts || workouts.length === 0) {
                list.innerHTML = '<div class="empty-state">No workouts added yet.<br>Add your workouts here when ready!</div>';
            } else {
                list.innerHTML = workouts.map(workout => {
                    const last = history.find(h => h.workoutId === workout.id);
                    let lastText = '';
                    if (last) lastText = `<small>Last: ${new Date(last.date).toLocaleDateString()}</small>`;
                    return `<div class="card" onclick='selectWorkout(${JSON.stringify(workout)})'>
                        <h3>${workout.name}</h3>
                        <p>${workout.info} ‚Ä¢ ${workout.duration} mins</p>
                        ${workout.equipment ? `<div class="equipment">Equipment: ${workout.equipment}</div>` : ''}
                        ${lastText}
                    </div>`;
                }).join('');
            }
        }

        function selectWorkout(workout) {
            selectedWorkout = workout;
            openModal();
        }

        function openModal() {
            document.getElementById('logDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('logDuration').value = selectedWorkout.duration || '';
            document.getElementById('logEquipment').value = selectedWorkout.equipment || '';
            document.getElementById('logNotes').value = '';
            
            let detailsHtml = `<strong>${selectedWorkout.name || 'Session ' + selectedWorkout.session}</strong>`;
            if (selectedWorkout.info) detailsHtml += `<div style="margin-top: 4px;">${selectedWorkout.info}</div>`;
            if (selectedWorkout.notes) detailsHtml += `<div style="margin-top: 4px; color: #059669;">üí° ${selectedWorkout.notes}</div>`;
            
            document.getElementById('workoutDetails').innerHTML = detailsHtml;
            document.getElementById('logModal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('logModal').classList.remove('show');
        }

        function saveWorkout() {
            const newLog = {
                id: Date.now(),
                type: selectedType.id,
                typeName: selectedType.name,
                cycle: selectedCycle,
                session: selectedWorkout?.session || null,
                workoutId: selectedWorkout?.id || null,
                workoutName: selectedWorkout?.name || `Cycle ${selectedCycle} Session ${selectedWorkout?.session}`,
                workoutInfo: selectedWorkout?.info || '',
                date: document.getElementById('logDate').value,
                duration: document.getElementById('logDuration').value,
                equipment: document.getElementById('logEquipment').value,
                notes: document.getElementById('logNotes').value
            };
            history.unshift(newLog);
            localStorage.setItem('workoutHistory', JSON.stringify(history));
            closeModal();
            showHome();
        }

        function showHistory() {
            hideAll();
            currentView = 'history';
            document.getElementById('historyView').classList.remove('hidden');
            document.getElementById('homeNavBtn').classList.remove('active');
            document.getElementById('historyNavBtn').classList.add('active');
            
            const list = document.getElementById('historyList');
            if (history.length === 0) {
                list.innerHTML = '<div class="empty-state">No workouts logged yet.<br>Start tracking your progress!</div>';
            } else {
                list.innerHTML = history.map(w => {
                    let metaItems = [];
                    metaItems.push(`üìÖ ${new Date(w.date).toLocaleDateString()}`);
                    if (w.duration) metaItems.push(`‚è±Ô∏è ${w.duration} mins`);
                    if (w.equipment) metaItems.push(`üèãÔ∏è ${w.equipment}`);
                    
                    let notesHtml = '';
                    if (w.notes) notesHtml = `<div class="notes">${w.notes}</div>`;
                    
                    return `<div class="history-card">
                        <h4>${w.workoutName}</h4>
                        ${w.workoutInfo ? `<p style="font-size: 13px; color: #6b7280; margin-bottom: 6px;">${w.workoutInfo}</p>` : ''}
                        <div class="meta">${metaItems.join(' ‚Ä¢ ')}</div>
                        ${notesHtml}
                    </div>`;
                }).join('');
            }
        }

        function goBack() {
            if (currentView === 'sessions') showCycles();
            else if (currentView === 'cycles' || currentView === 'workouts') showHome();
        }

        showHome();
    </script>
</body>
</html>
